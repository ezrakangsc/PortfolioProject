Practice Problems from https://www.sql-practice.com/

SELECT * FROM patients;

-- 1) Show all of the patients grouped into weight groups. 
-- Show the total amount of patients in each weight group. 
-- Order the list by the weight group decending

SELECT COUNT(*) AS patients_in_group, weight/10*10 AS weight_group FROM patients
  GROUP BY weight_group
  ORDER BY weight_group desc;
  -- Because weight is a integer, dividing by 10 automatically rounds down.
  -- We then multiply it by 10 to make their weight rounded down to the tens.
  -- If weight was a decimal number we could solve this by doing FLOOR(weight/10)*10
  
-- 2) Show patient_id, weight, height, isObese from the patients table.
-- Display isObese as a boolean 0 or 1. T = 1, F = 0
-- Obese is defined as weight(kg)/(height(m)2) >= 30.
-- weight is in units kg.
-- height is in units cm.
  
SELECT patient_id, weight, height, 
  (CASE 
    when weight/(POWER(height/100.0,2)) >= 30 THEN 1
    ELSE 0
  END) AS isObsese
FROM patients

-- 3) Show patient_id, first_name, last_name, and attending physician's specialty.
-- Show only the patients who has a primary_diagnosis as 'Dementia' 
-- and the physician's first name is 'Lisa' and last name is 'Cuddy'

-- Check patients, admissions, and physicians tables for required information

SELECT pa.patient_id, pa.first_name AS patient_first_name, pa.last_name AS patient_last_name, ph.specialty AS attending_physician_specialty
FROM patients pa
  JOIN admissions ad
    ON pa.patient_id = ad.patient_id
  JOIN physicians ph 
    ON ph.physician_id = ad.attending_physician_id
 WHERE primary_diagnosis = 'Dementia' 
   AND ph.first_name = 'Lisa' AND ph.last_name = 'Cuddy'
   
